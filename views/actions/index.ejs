<% layout('layouts/boilerplate') %>
<style type="text/css">

    .mapboxgl-popup-content {
        color: #F3F3DD;
        background-color: #2a1c5c;
        border-color: #262169;
        max-width: 320px;
        border-radius: 25px;
        box-shadow: 3px 3px 2px #12093a;
        font-family: 'Brush Script MT', cursive;
    }
    </style>
<div id="map" style="width:100%; height:500px"></div>

        <h1>All actions</h1>
        <div>
            <a href="/actions/new">Add an Action!</a>
        </div> 
        <ul>
<% for (let action of actions) { %>
    <div class="card mb-3">
     <div class="row">
         <div class="col-md-4">
             <% if(action.images.length) { %> 
             <img class="img-fluid show-image" alt="" src="<%=action.images[0].thumbnailforallactions %>">
             <% }else { %>
                <img class="img-fluid show-image" alt="" src="">
             <% } %>  
         </div>
         <div class="col-md-8">
             <div class="card-body">
                 <h5 class="card-title"><%= action.title %></h5>
                 <p class="card-text"><%=action.description %></p>
                 <p class="card-text">
                     <small class="text-muted">
                        <%= action.place %>
                     </small>
                    </p>
                    <a class="btn btn-primary" href="/actions/<%= action._id %>">View <%= action.title %></a>

             </div>
         </div>
     </div>

    </div>
<% } %>
        </ul>
         

        <script>
            const mapToken='<%- process.env.MAPBOX_TOKEN %>';
            const actions= {features:<%- JSON.stringify(actions) %>};
          </script>

        <script src="/javascripts/clusterMap.js"></script>